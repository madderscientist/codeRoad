# 画线框！
lab2文件夹中的程序存在问题：stl读取了看不出层级，一片颜色。解决方法是本文件夹的程序：画边线。由于不需要颜色，因此砍掉了颜色的传参，所以不能直接用到lab2的代码中。
## 原理
https://xiaoiver.github.io/coding/2018/10/22/Wireframe-%E7%9A%84%E5%AE%9E%E7%8E%B0.html
原理是GL栅格化的自动插值。如果三角形三个点A、B、C的属性分别为(1,0,0)、(0,1,0)、(0,0,1)（不是坐标，是一个参数），通过varying传给片元着色器，在栅格化的时候每个位置会计算出插值，这个插值(a,b,c)和这个像素点P的关系是：P = A*a + B*b + C*c，即计算出了P以基底{A, B, C}的线性表出参数。参考闭包的概念，线段上点参数和为1，在面片内参数和也为1，所以面片上靠近边的有一个参数会很小。所以只要参数中有一个小于某个阈值就视为边线。

## 实现
每个三角形的三个顶点都是(1,0,0)(0,1,0)(0,0,1)，用传参显然浪费。所以可以传点的序号，在glsl里面得到vec3
### 和gpt的对话
glsl中，能设置一个全局量，每调用一次顶点着色器就加一吗？我想要每3个点都按(1,0,0)(0,1,0)(0,0,1)循环给一个varing变量。
在GLSL中，无法直接设置一个全局量来在每次调用顶点着色器时自增。顶点着色器是为每个顶点调用的，而不是为每个顶点绘制的片段调用的。
但是，您可以通过使用顶点属性或uniform变量来实现您的需求。您可以将一个顶点属性用作索引，在每个顶点着色器调用时增加它，并将其与循环中定义的颜色值进行映射。
以下是一个示例，演示了如何实现按(1,0,0)(0,1,0)(0,0,1)循环给一个varying变量的效果：

```glsl
// 顶点着色器
attribute vec3 position;
varying vec3 color;

void main() {
    gl_Position = vec4(position, 1.0);

    // 计算索引值
    int index = gl_VertexID / 3;

    // 根据索引值设置颜色
    if (index % 3 == 0) {
        color = vec3(1.0, 0.0, 0.0); // 红色
    } else if (index % 3 == 1) {
        color = vec3(0.0, 1.0, 0.0); // 绿色
    } else {
        color = vec3(0.0, 0.0, 1.0); // 蓝色
    }
}
```

在此示例中，我们使用`gl_VertexID`内置变量来获取顶点的索引。然后，我们将索引除以3，得到一个循环索引，该索引每3个顶点增加一次。根据循环索引的值，我们设置相应的颜色。<br>
请注意，此示例假设您正在绘制的图形是由三个顶点的三角形组成。如果您绘制的是其他形状，您需要相应地调整索引计算和循环。<br>
`gl_VertexID`是一个内置变量，在顶点着色器中表示当前顶点的索引。它提供了一个从0开始的整数值，用于唯一标识每个顶点。<br>
当使用绘制命令（如glDrawArrays或glDrawElements）绘制图元时，顶点着色器将为每个顶点调用一次，并且可以使用`gl_VertexID`来获取当前顶点的索引。<br>
对于顶点数组绘制（glDrawArrays），`gl_VertexID`将从0开始递增，直到达到绘制的顶点数减1。<br>
对于索引数组绘制（glDrawElements），`gl_VertexID`将根据索引数组中的顺序递增。例如，如果索引数组中的第一个索引是3，那么`gl_VertexID`在绘制第一个顶点时将为3。<br>
通过使用`gl_VertexID`，您可以在顶点着色器中对每个顶点执行不同的操作，或者根据顶点的索引进行计算和映射操作。<br>
请注意，`gl_VertexID`变量只在顶点着色器中可用，并且在片段着色器中不可用。<br>

**但是！WEBGL中不能用！！！所以只能传参。**<br>
注意，取模这样写才不会报错：
```glsl
int index = int(mod(a_Barycentric, 3.0));
```
进一步优化，传参的a_Barycentric直接在cpu模3。详见代码（着色器部分和mesh生成数据部分）

# STL格式！
https://zhuanlan.zhihu.com/p/649115246
1. 前80个字节：字符串
2. 4字节的无符号整数：三角形个数
3. 三角形数据
三角形数据（按顺序）：
```
|- 法向向量
|   |- 4 byte float i
|   |- 4 byte float j
|   |- 4 byte float k
|
|- 第一个点的坐标
|   |- 4 byte float x
|   |- 4 byte float y
|   |- 4 byte float z
|
|- 第二个点的坐标
|   |- 4 byte float x
|   |- 4 byte float y
|   |- 4 byte float z
|
|- 第三个点的坐标
|   |- 4 byte float x
|   |- 4 byte float y
|   |- 4 byte float z
|
|- 2 byte unsigned integer 没什么用，跳过
```